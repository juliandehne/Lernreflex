#!/bin/bash
echo "$1"
if [ -z $1 ];
then
  ip=$(ifconfig en0 | grep inet | grep -v inet6 | awk '{print $2}')
else
  ip="$1"
fi
if [ -z $ip ];
then
  ip=$(ifconfig en1 | grep inet | grep -v inet6 | awk '{print $2}')
fi
echo $ip

if ! [ -z $ip ];
then
echo "var ip='"$ip"';" > localip.js
echo "module.exports = {ip:ip};" >> localip.js

#Change IP in iOS project
url="//.*:8081/index.ios.bundle"
sed -i -- "s|$url|//$ip:8081/index.ios.bundle|g" ios/reflect/AppDelegate.m

#Change IP in iOS debugger
url="//.*:%zd/debugger-proxy?role=client"
sed -i -- "s|$url|//$ip:%zd/debugger-proxy?role=client|g" node_modules/react-native/Libraries/WebSocket/RCTWebSocketExecutor.m

#Change IP in COMPBASE
sed -i -- "s/RESTURLCompetence.*/RESTURLCompetence = \"http:\/\/$ip:8084\";/g" /Users/ast/Projects/COMPBASE/util/src/main/java/config/MagicStrings.java
fi
